(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{369:function(n,e,s){"use strict";s.r(e);var t=s(45),a=Object(t.a)({},(function(){var n=this,e=n.$createElement,s=n._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("h1",{attrs:{id:"生产环境总的配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生产环境总的配置"}},[n._v("#")]),n._v(" 生产环境总的配置")]),n._v(" "),s("ol",[s("li",[n._v("修改webpack.config.js的配置")])]),n._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("const { resolve } = require('path');\nconst MiniCssExtractPlugin = require('mini-css-extract-plugin');\nconst OptimizeCssAssetsWebpackPlugin = require('optimize-css-assets-webpack-plugin');\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\n\n// 定义 nodejs 环境变量：决定使用 browserslist 的哪个环境\nprocess.env.NODE_ENV = 'production';\n\n// 复用 loader\nlet commonCssLoader = [\n  MiniCssExtractPlugin.loader,\n  'css-loader',\n  {\n    // 还需要在 package.json 中定义 browserslist\n    loader: 'postcss-loader',\n    options: {\n      ident: 'postcss',\n      plugins: () => [require('postcss-preset-env')()]\n    }\n  }\n];\n\nmodule.exports = {\n  entry: './src/js/index.js',\n  output: {\n    filename: 'js/built.js',\n    path: resolve(__dirname, 'build')\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.css$/,\n        use: [...commonCssLoader]\n      },\n      {\n        test: /\\.less$/,\n        use: [...commonCssLoader, 'less-loader']\n      },\n      /*正常来讲，一个文件只能被一个 loader 处理。\n        当一个文件要被多个 loader 处理，那么一定要指定 loader 执行的先后顺序：\n        先执行 eslint 在执行 babel\n      */\n      {\n        // 在 package.json 中 eslintConfig --\x3e airbnb\n        test: /\\.js$/,\n        exclude: /node_modules/,\n        // 优先执行\n        enforce: 'pre',\n        loader: 'eslint-loader',\n        options: {\n          fix: true\n        }\n      },\n      {\n        test: /\\.js$/,\n        exclude: /node_modules/,\n        loader: 'babel-loader',\n        options: {\n          presets: [\n            [\n              '@babel/preset-env',\n              {\n                useBuiltIns: 'usage',\n                corejs: {\n                  version: 3\n                },\n                targets: {\n                  chrome: '60',\n                  firefox: '60',\n                  ie: '9',\n                  safari: '10',\n                  edge: '17'\n                }\n              }\n            ]\n          ]\n        }\n      },\n      {\n        test: /\\.(png|jpg|gif)$/,\n        loader: 'url-loader',\n        options: {\n          limit: 73 * 1024,\n          name: '[hash:10].[ext]',\n          outputPath: 'imgs'\n        }\n      },\n      {\n        exclude: /\\.(html|css|less|js|png|jpg|gif)$/,\n        loader: 'file-loader',\n        options: {\n          name: '[hash:10].[ext]',\n          outputPath: 'media'\n        }\n      }\n    ]\n  },\n  plugins: [\n    new OptimizeCssAssetsWebpackPlugin(),\n    new HtmlWebpackPlugin({\n      template: './src/index.html',\n      minify: {\n        collapseWhitespace: true,\n        removeComments: true\n      }\n    }),\n    new MiniCssExtractPlugin({\n      filename: 'css/built.css'\n    })\n  ],\n  mode: 'production'\n};\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[n._v("在package.json中添加browserslist属性")])]),n._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('"browserslist": {\n    "development": [\n      "last 1 chrome version",\n      "last 1 firefox version",\n      "last 1 safari version"\n    ],\n    "production": [\n      ">0.2%",\n      "not dead",\n      "not op_mini all"\n    ]\n}\n')])])]),s("ol",{attrs:{start:"3"}},[s("li",[n._v("在package.json中添加eslintConfig属性")])]),n._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('"eslintConfig": {\n    "extends": "airbnb-base",\n    "env": {\n      "browser": true\n    }\n}\n')])])]),s("ol",{attrs:{start:"4"}},[s("li",[n._v("运行webpack")])])])}),[],!1,null,null,null);e.default=a.exports}}]);